<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>geo_get.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3-20001105 on Sun Mar 4 23:32:44 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>geo_get.c</h1><div class="fragment"><pre>00001 <font class="comment">/**********************************************************************</font>
00002 <font class="comment"> *</font>
00003 <font class="comment"> *  geo_get.c  -- Public routines for GEOTIFF GeoKey access.</font>
00004 <font class="comment"> *</font>
00005 <font class="comment"> *    Written By: Niles D. Ritter.</font>
00006 <font class="comment"> *</font>
00007 <font class="comment"> *  copyright (c) 1995   Niles D. Ritter</font>
00008 <font class="comment"> *</font>
00009 <font class="comment"> *  Permission granted to use this software, so long as this copyright</font>
00010 <font class="comment"> *  notice accompanies any products derived therefrom.</font>
00011 <font class="comment"> *</font>
00012 <font class="comment"> *  Revision History;</font>
00013 <font class="comment"> *</font>
00014 <font class="comment"> *    20 June, 1995      Niles D. Ritter         New</font>
00015 <font class="comment"> *    3 July,  1995      Greg Martin             Fix strings and index</font>
00016 <font class="comment"> *    6 July,  1995      Niles D. Ritter         Unfix indexing.</font>
00017 <font class="comment"> *</font>
00018 <font class="comment"> **********************************************************************/</font>
00019 
00020 <font class="preprocessor">#include "<a class="code" href="geotiff_h.html">geotiff.h</a>"</font>   <font class="comment">/* public interface        */</font>
00021 <font class="preprocessor">#include "geo_tiffp.h"</font> <font class="comment">/* external TIFF interface */</font>
00022 <font class="preprocessor">#include "geo_keyp.h"</font>  <font class="comment">/* private interface       */</font>
00023 
00024 <font class="comment">/* return the Header info of this geotiff file */</font>
00025 
00026 <font class="keywordtype">void</font> GTIFDirectoryInfo(GTIF *gtif, <font class="keywordtype">int</font> version[3], <font class="keywordtype">int</font> *keycount)<font class="keyword"></font>
00027 <font class="keyword"></font>{
00028         <font class="keywordflow">if</font> (version)
00029         {
00030                 version[0]  = gtif-&gt;gt_version;
00031                 version[1]  = gtif-&gt;gt_rev_major;
00032                 version[2]  = gtif-&gt;gt_rev_minor;
00033         }
00034         <font class="keywordflow">if</font> (keycount) *keycount = gtif-&gt;gt_num_keys;
00035 }
00036 
00037 
00038 <font class="keywordtype">int</font> GTIFKeyInfo(GTIF *gtif, geokey_t key, <font class="keywordtype">int</font> *size, tagtype_t* type)<font class="keyword"></font>
00039 <font class="keyword"></font>{
00040         <font class="keywordtype">int</font> index = gtif-&gt;gt_keyindex[ key ];
00041         GeoKey *keyptr;
00042 
00043         <font class="keywordflow">if</font> (!index) <font class="keywordflow">return</font> 0;
00044 
00045         keyptr = gtif-&gt;gt_keys + index;
00046         <font class="keywordflow">if</font> (size) *size = (<font class="keywordtype">int</font>) keyptr-&gt;gk_size;
00047         <font class="keywordflow">if</font> (type) *type = keyptr-&gt;gk_type;
00048 
00049         <font class="keywordflow">return</font> keyptr-&gt;gk_count;
00050 }
00051 
00150 <font class="keywordtype">int</font> <a class="code" href="geotiff_h.html#a23">GTIFKeyGet</a>(GTIF *gtif, geokey_t thekey, <font class="keywordtype">void</font> *val, <font class="keywordtype">int</font> index, <font class="keywordtype">int</font> count)<font class="keyword"></font>
00151 <font class="keyword"></font>{
00152         <font class="keywordtype">int</font> kindex = gtif-&gt;gt_keyindex[ thekey ];
00153         GeoKey *key;
00154         gsize_t size;
00155         <font class="keywordtype">char</font> *data;
00156         tagtype_t type;
00157 
00158         <font class="keywordflow">if</font> (!kindex) <font class="keywordflow">return</font> 0;
00159 
00160         key = gtif-&gt;gt_keys+kindex;
00161         <font class="keywordflow">if</font> (!count) count = key-&gt;gk_count - index;
00162         <font class="keywordflow">if</font> (count &lt;=0) <font class="keywordflow">return</font> 0;
00163         <font class="keywordflow">if</font> (count &gt; key-&gt;gk_count) count = key-&gt;gk_count;
00164         size = key-&gt;gk_size;
00165         type = key-&gt;gk_type;
00166 
00167         <font class="keywordflow">if</font> (count==1 &amp;&amp; type==TYPE_SHORT) data = (<font class="keywordtype">char</font> *)&amp;key-&gt;gk_data;
00168         <font class="keywordflow">else</font> data = key-&gt;gk_data;
00169 
00170         _GTIFmemcpy( val, data + index*size, count*size );
00171 
00172         <font class="keywordflow">if</font> (type==TYPE_ASCII)
00173            ((<font class="keywordtype">char</font> *)val)[count-1] = <font class="charliteral">'\0'</font>; <font class="comment">/* replace last char with NULL */</font>
00174 
00175         <font class="keywordflow">return</font> count;
00176 }
</div></pre><hr><address><small>Generated at Sun Mar 4 23:32:44 2001 for libgeotiff by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3-20001105 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
